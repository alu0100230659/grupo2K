%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Chapter 3: Procedimiento experimental 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

En este apartado se explicará el procedimiento que se ha seguido para obtener, 
tanto el valor exacto, como el valor aproximado a través de la regla de Simpson,
de la integral definida:

\[ \int_{1}^{3} x^2\ cos\ x\ \text{d}x \]

A continuación se procederá a la comparación de ambos resultados. 
A modo de curiosidad se aplicará la regla de Simpson compuesta para observar la 
mejora en la aproximación.
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Descripción de los experimentos}
\label{3:sec:1}

Los experimentos realizados son los siguientes:

\begin{itemize}
 \item Representación gráfica de la función.
 \item Cálculo del valor exacto de la integral definida.
 \item Comparación grafica. 
 \item Aproximación por la Regla de Simpson.
 \item Aproximación por la Regla de Simpson compuesta.
\end{itemize}

\subsection{Representación gráfica de la función.}

Se implementa en Python un programa que representa la gráfica de la función

\begin{equation}
 f(x)=x^2\ cos\ x
 \label{funcion}
\end{equation}

como se puede ver en el apéndice~\ref{Apendice1:grafica1}, obteniendo como 
resultado la figura~\ref{grafica1}.

\begin{figure}[H]
  \begin{center}
    \includegraphics[width=0.75\textwidth]{images/grafica1.eps}
    \caption{Representación gráfica de la función a integrar.}
    \label{grafica1}
  \end{center}
\end{figure}

\subsection{Cálculo del valor exacto de la integral definida.}

A continuación se detallarán los pasos seguidos para obtener el valor exacto de la 
integral definida de la función~\ref{funcion} en el intervalo acotado $[1,3]$,
utilizando el segundo teorema fundamental del cálculo integral (o Regla de Barrow).

Se quiere calcular:

\[ \int_{1}^{3} x^2\ cos\ x\ \text{d}x \]

Primero se resuelve la integral indefinida aplicando el método de integración por 
partes $\left(\int u \text{d}v = uv - \int v \text{d}u\right)$ tal que:
\[ \int x^2\ cos\ x\ \text{d}x =\]\par

\[u=x^2, \quad \text{d}u = 2x\ \text{d}x\] 
\[\text{d}v = cos\ x\ \text{d}x, \quad v = sen\ x \]

Con lo que se obtiene:

\[ \int x^2\ cos\ x\ \text{d}x = x^2 sen\ x - \int 2x sen\ x\ \text{d}x = \]

Empleando de nuevo la integración por partes:

\[ u=2x, \quad \text{d}u = 2\ \text{d}x\]
\[\text{d}v = sen\ x\ \text{d}x, \quad v = -cos\ x \]

Se sigue:

\[ = x^2 sen\ x - \left[-2x cos\ x + 2\int cos\ x\ \text{d}x \right] = 
x^2 sen\ x +2x cos\ x - 2sen\ x = \]

\begin{equation}
 2x cos\ x + (x^2 -2)sen\ x
 \label{primitiva}
\end{equation}

Por último se obtiene el valor buscado a través de la Regla de Barrow en el 
intervalo $[1,3]$. Para ello se empleará el lenguaje de programación interpretado
Python, evaluando la expresión ~\ref{primitiva}, el resultado se muestra en la 
tabla~\ref{tab:1}, que se encuentra en la página~\pageref{tab:1}.
Se puede ver el código Python en el apéndice~\ref{Apendice3:error1} 

\subsection{Comparación gráfica.}
\begin{figure}[h]
  \begin{center}
    \includegraphics[width=0.75\textwidth]{images/grafica2.eps}
    \caption{Funcion vs. Polinomio interpolador}
    \label{grafica2}
  \end{center}
\end{figure}
En esta sección se obtendrá la expresión del polinomio interpolador de la regla de Simpson.
Para ello, se busca la expresión del polinomio de grado dos que pasa por los puntos 
$(1,f(1)),(2,f(2))\ \text{y}\ (3,f(3))$ de la función~\ref{funcion}.

De esta forma, tenemos:

\[a 1^2 + b 1 + c = f(1)\]
\[a 2^2 + b 2 + c = f(2)\]
\[a 3^2 + b 3 + c = f(3)\]

Obteniendo como resultado:

\begin{equation}
 P_2(x) = -2.520227735 x^2 + 5.355793554 x - 2.295263513
 \label{pol}
\end{equation}

A continuación se implementa en Python un programa que representa la gráfica $P_2(x)$, frente
a $f(x)$, como se puede ver en el apéndice~\ref{Apendice1:grafica2}, obteniendo como resultado 
la figura~\ref{grafica2}.



\subsection{Aproximación por la regla de Simpson.}

Para el cálculo de una aproximación de la integral:

\[ \int_{1}^{3} x^2\ cos\ x\ \text{d}x \]

se emplea el lenguaje Python, implementando una función que recibe por 
parámetros la expresión a estudiar y los extremos del intervalo donde se va a calcular, 
devolviendo la aproximación buscada, el resultado se muestra en la tabla~\ref{tab:1},
que se encuentra en la página~\pageref{tab:1}. Se puede ver el código Python en el 
apéndice~\ref{Apendice3:error1}

\subsection{Aproximación por la regla de Simpson compuesta.}

Para un mejor análisis de los resultados, se repite el estudio aplicando la Regla de 
Simpson compuesta, implementando una función en Python que recibe por parámetros la expresión a estudiar, 
los extremos del intervalo y el número par de subintervalos en los que se ha dividido, devolviendo la 
aproximación buscada, el resultado se muestra en la tabla~\ref{tab:2}, que se encuentra en la 
página~\pageref{tab:2}. Se puede ver el código Python en el apéndice~\ref{Apendice3:error2}.

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Descripción del material}
\label{3:sec:2}
Las características del ordenador empleado para la realización de este trabajo son las siguientes:
\begin{itemize}
 \item CPU type: Intel(R) Atom(TM) CPU N270   @ 1.60GHz
 \item CPU speed: 800.000Hz
 \item Cache size: 512 KB
\end{itemize}
En cuanto al sistema operativo, se ha utilizado ``Linux-3.2.0-39-generic-i686-with-Ubuntu-12.04-precise''.
Los ficheros en lenguaje Python fueron realizados con el editor de textos avanzado para KDE ``Kate''.

%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
\section{Resultados obtenidos}
\label{3:sec:3}

%------------------------------------------------------------------------------
\input{tables/table1.tex}
%------------------------------------------------------------------------------
\input{tables/table2.tex}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

\section{Análisis de los resultados}
\label{3:sec:4}

%------------------------------------------------------------------------------
\input{tables/table3.tex}
%------------------------------------------------------------------------------
\input{tables/table4.tex}
%++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

Como se puede apreciar en la tabla~\ref{tab:3}, el error cometido al aplicar la regla de Simpson,
garantiza, para la función estudiada, una precisión de por lo menos una cifra decimal exacta.
Por otro lado, se puede observar en la tabla~\ref{tab:4}, que empleando la regla de Simpson compuesta el error es 
inversamente proporcional al número de subintervalos, siendo posible reducirlo tanto como se desee.
